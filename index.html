<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Video Downloader - All Platforms</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --dark-blue: #0a1628;
            --medium-blue: #1a2a4a;
            --bright-blue: #00a8ff;
            --light-blue: #0097e6;
            --white: #ffffff;
            --glass: rgba(255, 255, 255, 0.1);
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--dark-blue) 0%, #0d2137 50%, var(--medium-blue) 100%);
            color: var(--white);
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(0, 168, 255, 0.1);
            animation: move 25s infinite;
            bottom: -150px;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 10%; width: 80px; height: 80px; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 20%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
        .bg-animation span:nth-child(3) { left: 35%; width: 60px; height: 60px; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 50%; width: 40px; height: 40px; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; width: 90px; height: 90px; animation-delay: 3s; }

        @keyframes move {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-1500px) rotate(720deg); opacity: 0; }
        }

        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: rgba(10, 22, 40, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 18px;
        }

        .nav-logo i {
            color: var(--bright-blue);
            font-size: 22px;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border-radius: 10px;
            text-decoration: none;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
        }

        .nav-btn.tiktok {
            background: linear-gradient(135deg, #000000, #25F4EE);
            color: white;
        }

        .nav-btn.telegram {
            background: linear-gradient(135deg, #0088cc, #00a8e8);
            color: white;
        }

        .nav-btn.donate {
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            color: white;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(243, 156, 18, 0.5); }
            50% { box-shadow: 0 0 20px rgba(243, 156, 18, 0.8); }
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        .nav-btn i {
            font-size: 16px;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 200;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-box {
            background: linear-gradient(135deg, var(--medium-blue), var(--dark-blue));
            border-radius: 25px;
            padding: 30px;
            max-width: 380px;
            width: 100%;
            border: 1px solid rgba(0, 168, 255, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.4s ease;
            text-align: center;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #f39c12, #e74c3c);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 35px;
            animation: bounce 1s ease infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(90deg, #f39c12, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .payment-methods {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .payment-label {
            font-size: 14px;
            color: var(--bright-blue);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .payment-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .payment-badge {
            background: rgba(0, 168, 255, 0.2);
            border: 1px solid rgba(0, 168, 255, 0.4);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .phone-number {
            font-size: 28px;
            font-weight: 700;
            color: var(--white);
            margin: 15px 0;
            letter-spacing: 2px;
        }

        .phone-number i {
            color: #00d26a;
            margin-right: 10px;
        }

        .account-name {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 15px;
        }

        .account-name span {
            color: var(--bright-blue);
            font-weight: 600;
        }

        .thank-message {
            font-size: 18px;
            color: #f39c12;
            margin-top: 15px;
        }

        .copy-btn {
            background: var(--bright-blue);
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: var(--light-blue);
            transform: scale(1.05);
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 80px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            animation: fadeInDown 1s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            width: 65px;
            height: 65px;
            background: linear-gradient(135deg, var(--bright-blue), var(--light-blue));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            animation: pulse 2s infinite;
            box-shadow: 0 10px 40px rgba(0, 168, 255, 0.4);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-text {
            font-size: 26px;
            font-weight: 700;
            background: linear-gradient(90deg, var(--white), var(--bright-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .platform-badges {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .platform-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(0, 168, 255, 0.15);
            border: 1px solid rgba(0, 168, 255, 0.3);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .platform-badge i {
            font-size: 14px;
        }

        .search-box {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .input-field {
            flex: 1;
            min-width: 200px;
            padding: 16px 22px;
            border: 2px solid rgba(0, 168, 255, 0.3);
            border-radius: 14px;
            background: rgba(0, 0, 0, 0.3);
            color: var(--white);
            font-size: 15px;
            transition: all 0.3s ease;
            outline: none;
        }

        .input-field::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .input-field:focus {
            border-color: var(--bright-blue);
            box-shadow: 0 0 20px rgba(0, 168, 255, 0.3);
        }

        .search-btn {
            padding: 16px 35px;
            background: linear-gradient(135deg, var(--bright-blue), var(--light-blue));
            border: none;
            border-radius: 14px;
            color: var(--white);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 30px rgba(0, 168, 255, 0.3);
        }

        .search-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .search-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .search-btn .spinner {
            display: none;
            animation: spin 0.8s linear infinite;
        }

        .search-btn.loading .spinner { display: inline-block; }
        .search-btn.loading .search-icon { display: none; }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        .status-box {
            margin-top: 15px;
            padding: 12px 18px;
            border-radius: 10px;
            display: none;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .status-box.show { display: flex; }
        .status-box.loading {
            background: rgba(0, 168, 255, 0.15);
            border: 1px solid rgba(0, 168, 255, 0.3);
            color: var(--bright-blue);
        }
        .status-box.error {
            background: rgba(255, 71, 87, 0.15);
            border: 1px solid rgba(255, 71, 87, 0.3);
            color: #ff6b7a;
        }
        .status-box.success {
            background: rgba(0, 210, 106, 0.15);
            border: 1px solid rgba(0, 210, 106, 0.3);
            color: #00d26a;
        }

        .video-result {
            display: none;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: scaleIn 0.4s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .video-result.show { display: block; }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .video-preview {
            position: relative;
            width: 100%;
            max-width: 320px;
            margin: 0 auto 20px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
            background: #000;
        }

        .video-preview video {
            width: 100%;
            max-height: 450px;
            display: block;
        }

        .video-preview img {
            width: 100%;
            display: block;
        }

        .video-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .video-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.5;
            max-height: 70px;
            overflow: hidden;
        }

        .video-author {
            color: var(--bright-blue);
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .video-stats {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .stat-badge {
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(0, 0, 0, 0.3);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
        }

        .stat-badge i { color: var(--bright-blue); font-size: 11px; }

        .download-section { margin-top: 20px; }

        .download-label {
            text-align: center;
            margin-bottom: 12px;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
        }

        .download-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
        }

        .dl-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            text-decoration: none;
            color: var(--white);
        }

        .dl-btn.hd {
            background: linear-gradient(135deg, #00d26a, #00b359);
            box-shadow: 0 6px 20px rgba(0, 210, 106, 0.3);
        }

        .dl-btn.sd {
            background: linear-gradient(135deg, var(--bright-blue), var(--light-blue));
            box-shadow: 0 6px 20px rgba(0, 168, 255, 0.3);
        }

        .dl-btn.audio {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .dl-btn:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        .badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 700;
        }

        .history-section {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 20px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i { color: var(--bright-blue); }

        .clear-btn {
            padding: 6px 12px;
            background: rgba(255, 71, 87, 0.2);
            border: 1px solid rgba(255, 71, 87, 0.3);
            border-radius: 6px;
            color: #ff6b7a;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .history-list::-webkit-scrollbar { width: 4px; }
        .history-list::-webkit-scrollbar-thumb { background: var(--bright-blue); border-radius: 10px; }

        .history-item {
            display: flex;
            gap: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .history-thumb {
            width: 50px;
            height: 65px;
            border-radius: 6px;
            object-fit: cover;
            background: var(--medium-blue);
        }

        .history-info {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .history-title {
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .history-meta {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
        }

        .history-actions {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .history-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: var(--white);
            font-size: 12px;
        }

        .history-btn.dl { background: var(--bright-blue); }
        .history-btn.del { background: rgba(255, 71, 87, 0.3); color: #ff6b7a; }

        .empty-state {
            text-align: center;
            padding: 30px;
            color: rgba(255, 255, 255, 0.4);
        }

        .empty-state i {
            font-size: 35px;
            margin-bottom: 10px;
            opacity: 0.3;
        }

        .stats-row {
            display: flex;
            justify-content: center;
            gap: 25px;
            padding: 15px;
            background: var(--glass);
            border-radius: 15px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
        }

        .stat-box { text-align: center; }
        .stat-num { font-size: 22px; font-weight: 700; color: var(--bright-blue); }
        .stat-label { font-size: 11px; color: rgba(255, 255, 255, 0.5); }

        .toast {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            padding: 10px 20px;
            background: var(--medium-blue);
            border-radius: 10px;
            color: var(--white);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast.success { border: 1px solid #00d26a; }
        .toast.error { border: 1px solid #ff4757; }

        .footer {
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.3);
            font-size: 11px;
        }

        @media (max-width: 600px) {
            .nav-btn span { display: none; }
            .nav-btn { padding: 10px 12px; }
            .nav-btn i { font-size: 18px; }
            .container { padding: 15px; padding-top: 70px; }
            .logo-icon { width: 50px; height: 50px; font-size: 26px; }
            .logo-text { font-size: 20px; }
            .search-box { padding: 18px; }
            .input-field { min-width: 100%; padding: 14px 18px; }
            .search-btn { width: 100%; justify-content: center; }
            .download-grid { grid-template-columns: 1fr 1fr; }
            .modal-box { padding: 25px 20px; }
            .phone-number { font-size: 22px; }
            .platform-badges { gap: 8px; }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span><span></span><span></span><span></span><span></span><span></span>
    </div>

    <nav class="top-nav">
        <div class="nav-logo">
            <i class="fas fa-download"></i>
            <span>AllSaver</span>
        </div>
        <div class="nav-buttons">
            <a href="https://tiktok.com/@babysmile7861" target="_blank" class="nav-btn tiktok">
                <i class="fab fa-tiktok"></i>
                <span>TikTok</span>
            </a>
            <a href="https://t.me/OPPER101" target="_blank" class="nav-btn telegram">
                <i class="fab fa-telegram-plane"></i>
                <span>Telegram</span>
            </a>
            <button class="nav-btn donate" onclick="openDonateModal()">
                <i class="fas fa-wallet"></i>
                <span>·Äô·ÄØ·Äî·Ä∑·Ä∫·Äñ·Ä≠·ÄØ·Ä∏</span>
            </button>
        </div>
    </nav>

    <div class="modal-overlay" id="donateModal" onclick="closeDonateModal(event)">
        <div class="modal-box" onclick="event.stopPropagation()">
            <div class="modal-icon">
                <i class="fas fa-heart"></i>
            </div>
            <h2 class="modal-title">·Äô·ÄØ·Äî·Ä∑·Ä∫·Äñ·Ä≠·ÄØ·Ä∏·Äï·Ä±·Ä∏·Äõ·Äî·Ä∫</h2>
            
            <div class="payment-methods">
                <div class="payment-label">Payment Methods</div>
                <div class="payment-options">
                    <span class="payment-badge">KPay</span>
                    <span class="payment-badge">Wave</span>
                    <span class="payment-badge">AYA</span>
                    <span class="payment-badge">UAB</span>
                </div>
                
                <div class="phone-number">
                    <i class="fas fa-phone"></i>
                    09786284670
                </div>
                
                <div class="account-name">
                    Name: <span>DHMK/NK</span>
                </div>
                
                <button class="copy-btn" onclick="copyPhoneNumber()">
                    <i class="fas fa-copy"></i>
                    Copy Number
                </button>
            </div>
            
            <div class="thank-message">
                ·ÄÖ·Ä±·Äê·Äî·Ä¨·Äõ·Äæ·Ä≠·Äû·Äú·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä±·Ä∏ ü•∞
            </div>
        </div>
    </div>

    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMsg"></span>
    </div>

    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-cloud-download-alt"></i></div>
                <span class="logo-text">All Media Saver</span>
            </div>
            <p class="subtitle">Download Videos & Images from All Social Media</p>
            <div class="platform-badges">
                <span class="platform-badge"><i class="fab fa-tiktok"></i> TikTok</span>
                <span class="platform-badge"><i class="fab fa-instagram"></i> Instagram</span>
                <span class="platform-badge"><i class="fab fa-facebook"></i> Facebook</span>
                <span class="platform-badge"><i class="fab fa-youtube"></i> YouTube</span>
            </div>
        </header>

        <div class="search-box">
            <div class="input-wrapper">
                <input type="text" class="input-field" id="urlInput" 
                       placeholder="Link ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´... (TikTok, Instagram, Facebook, YouTube)">
                <button class="search-btn" id="searchBtn" onclick="fetchVideo()">
                    <i class="fas fa-spinner spinner"></i>
                    <i class="fas fa-search search-icon"></i>
                    <span>·Äõ·Äæ·Ä¨·Äô·Ää·Ä∫</span>
                </button>
            </div>
            <div class="status-box" id="statusBox">
                <i id="statusIcon" class="fas fa-spinner fa-spin"></i>
                <span id="statusText"></span>
            </div>
        </div>

        <div class="video-result" id="videoResult">
            <div class="video-preview" id="mediaPreview">
                <video id="videoPlayer" controls playsinline style="display:none;"></video>
                <img id="imagePreview" style="display:none;">
            </div>
            <div class="video-info">
                <h3 class="video-title" id="vidTitle"></h3>
                <div class="video-author">
                    <i class="fas fa-user-circle"></i>
                    <span id="vidAuthor"></span>
                </div>
            </div>
            <div class="video-stats" id="vidStats"></div>
            <div class="download-section">
                <div class="download-label">üì• Download Options</div>
                <div class="download-grid" id="downloadBtns"></div>
            </div>
        </div>

        <div class="stats-row">
            <div class="stat-box">
                <div class="stat-num" id="statTotal">0</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat-box">
                <div class="stat-num" id="statToday">0</div>
                <div class="stat-label">Today</div>
            </div>
            <div class="stat-box">
                <div class="stat-num" id="statSaved">0</div>
                <div class="stat-label">Saved</div>
            </div>
        </div>

        <div class="history-section">
            <div class="section-head">
                <h2 class="section-title">
                    <i class="fas fa-history"></i>
                    History
                </h2>
                <button class="clear-btn" onclick="clearAllHistory()">
                    <i class="fas fa-trash-alt"></i>
                    Clear
                </button>
            </div>
            <div class="history-list" id="historyList">
                <div class="empty-state">
                    <i class="fas fa-download"></i>
                    <p>No downloads yet</p>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>Social Media Video Downloader - All Platforms Supported</p>
        </footer>
    </div>

    <script>
        // ========== CONFIG ==========
        const API_KEY = 'sk_mlf621q2_12e14adcf4ac26d8502441be7d2603d126f140043a33930e78e2b8b66ee6a08c';
        const API_BASE = 'https://api.novita.ai';
        
        const STORAGE = {
            history: 'sm_history',
            stats: 'sm_stats',
            device: 'sm_device'
        };

        // ========== INIT ==========
        document.addEventListener('DOMContentLoaded', () => {
            initDevice();
            loadHistory();
            updateStats();

            document.getElementById('urlInput').addEventListener('keypress', e => {
                if (e.key === 'Enter') fetchVideo();
            });
        });

        function initDevice() {
            if (!localStorage.getItem(STORAGE.device)) {
                localStorage.setItem(STORAGE.device, 'dev_' + Date.now());
            }
        }

        function getDeviceId() {
            return localStorage.getItem(STORAGE.device);
        }

        // ========== DONATE MODAL ==========
        function openDonateModal() {
            document.getElementById('donateModal').classList.add('show');
        }

        function closeDonateModal(e) {
            if (e.target === document.getElementById('donateModal')) {
                document.getElementById('donateModal').classList.remove('show');
            }
        }

        function copyPhoneNumber() {
            navigator.clipboard.writeText('09786284670').then(() => {
                showToast('·Äñ·ÄØ·Äî·Ä∫·Ä∏·Äî·Ä∂·Äï·Ä´·Äê·Ä∫ Copy ·Äï·Äº·ÄÆ·Ä∏·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
            });
        }

        // ========== UI ==========
        function showStatus(msg, type = 'loading') {
            const box = document.getElementById('statusBox');
            const icon = document.getElementById('statusIcon');
            document.getElementById('statusText').textContent = msg;
            box.className = 'status-box show ' + type;
            icon.className = type === 'loading' ? 'fas fa-spinner fa-spin' : 
                            type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
        }

        function hideStatus() {
            document.getElementById('statusBox').classList.remove('show');
        }

        function setLoading(isLoading) {
            const btn = document.getElementById('searchBtn');
            btn.disabled = isLoading;
            btn.classList.toggle('loading', isLoading);
        }

        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            toast.className = 'toast show ' + type;
            toast.querySelector('i').className = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        function formatNum(n) {
            if (!n) return '0';
            n = parseInt(n);
            if (n >= 1000000) return (n / 1000000).toFixed(1) + 'M';
            if (n >= 1000) return (n / 1000).toFixed(1) + 'K';
            return n.toString();
        }

        function isValidUrl(url) {
            return url && /tiktok\.com|instagram\.com|facebook\.com|youtube\.com|youtu\.be|fb\.watch|vm\.tiktok|vt\.tiktok/i.test(url);
        }

        function detectPlatform(url) {
            if (/tiktok/i.test(url)) return 'TikTok';
            if (/instagram/i.test(url)) return 'Instagram';
            if (/facebook|fb\.watch/i.test(url)) return 'Facebook';
            if (/youtube|youtu\.be/i.test(url)) return 'YouTube';
            return 'Unknown';
        }

        function isYouTubeUrl(url) {
            return /youtube\.com|youtu\.be/i.test(url);
        }

        // ========== FETCH VIDEO ==========
        async function fetchVideo() {
            const url = document.getElementById('urlInput').value.trim();
            
            document.getElementById('videoResult').classList.remove('show');
            hideStatus();

            if (!url) {
                showStatus('Link ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´', 'error');
                return;
            }

            if (!isValidUrl(url)) {
                showStatus('TikTok, Instagram, Facebook ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ YouTube Link ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´', 'error');
                return;
            }

            const platform = detectPlatform(url);
            const isYouTube = isYouTubeUrl(url);
            setLoading(true);
            showStatus(`${platform} ·Äõ·Äæ·Ä¨·Äñ·ÄΩ·Ä±·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...`, 'loading');

            try {
                // Choose endpoint based on platform
                const endpoint = isYouTube ? '/api/youtube-info-v2' : '/api/all-in-one-downloader-api';
                const apiUrl = `${API_BASE}${endpoint}`;
                
                const requestBody = {
                    url: url
                };

                console.log('Fetching:', apiUrl);
                console.log('Request body:', requestBody);
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-KEY': API_KEY,
                        'X_api_d9': API_KEY
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Error response:', errorText);
                    throw new Error('API Error: ' + response.status);
                }

                const data = await response.json();
                console.log('Response data:', data);

                // Check for error in response
                if (data.error || data.status === 'error') {
                    showStatus('Error: ' + (data.message || 'Unknown error'), 'error');
                    showToast(data.message || 'API Error', 'error');
                    setLoading(false);
                    return;
                }

                // Check if we have valid data
                if (data && (data.url || data.download_url || data.medias || data.formats || data.links || data.data)) {
                    displayResult(data, url, platform);
                    showStatus('·Äê·ÄΩ·Ä±·Ä∑·Äõ·Äæ·Ä≠·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
                    setTimeout(hideStatus, 1500);
                } else {
                    showStatus('Media ·Äô·Äê·ÄΩ·Ä±·Ä∑·Äï·Ä´·Åã Link ·Äï·Äº·Äî·Ä∫·ÄÖ·ÄÖ·Ä∫·Äï·Ä´', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showStatus('·ÄÅ·Äª·Ä≠·Äê·Ä∫·ÄÜ·ÄÄ·Ä∫·Äô·Äæ·ÄØ ·Äô·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´ - ' + error.message, 'error');
                showToast('API Error: ' + error.message, 'error');
            }

            setLoading(false);
        }

        // ========== DISPLAY RESULT ==========
        function displayResult(data, originalUrl, platform) {
            const videoPlayer = document.getElementById('videoPlayer');
            const imagePreview = document.getElementById('imagePreview');
            
            videoPlayer.style.display = 'none';
            imagePreview.style.display = 'none';

            // Extract data (handle nested data structure)
            let videoData = data.data || data;

            // Set title and author
            const title = videoData.title || videoData.caption || videoData.description || 
                         videoData.meta?.title || `${platform} Media`;
            const author = videoData.author || videoData.username || videoData.uploader || 
                          videoData.channel || videoData.owner?.username || 'Unknown';

            document.getElementById('vidTitle').textContent = title;
            document.getElementById('vidAuthor').textContent = '@' + author;

            // Display stats
            let statsHtml = '';
            const stats = videoData.statistics || videoData.stats || videoData;
            
            if (stats.likes || stats.like_count || stats.likeCount) {
                statsHtml += `<div class="stat-badge"><i class="fas fa-heart"></i> ${formatNum(stats.likes || stats.like_count || stats.likeCount)}</div>`;
            }
            if (stats.comments || stats.comment_count || stats.commentCount) {
                statsHtml += `<div class="stat-badge"><i class="fas fa-comment"></i> ${formatNum(stats.comments || stats.comment_count || stats.commentCount)}</div>`;
            }
            if (stats.shares || stats.share_count || stats.shareCount) {
                statsHtml += `<div class="stat-badge"><i class="fas fa-share"></i> ${formatNum(stats.shares || stats.share_count || stats.shareCount)}</div>`;
            }
            if (stats.views || stats.view_count || stats.viewCount || stats.playCount) {
                statsHtml += `<div class="stat-badge"><i class="fas fa-play"></i> ${formatNum(stats.views || stats.view_count || stats.viewCount || stats.playCount)}</div>`;
            }
            
            document.getElementById('vidStats').innerHTML = statsHtml;

            // Get thumbnail
            let thumbnailUrl = videoData.thumbnail || videoData.cover || videoData.image || 
                              videoData.thumbnailUrl || videoData.cover_image || videoData.picture || '';

            // Handle download links
            let btnsHtml = '';
            let foundMedia = false;

            // Check for direct video URL
            const videoUrl = videoData.url || videoData.download_url || videoData.video || 
                           videoData.videoUrl || videoData.video_url || videoData.downloadUrl;

            if (videoUrl) {
                foundMedia = true;
                videoPlayer.src = videoUrl;
                videoPlayer.poster = thumbnailUrl;
                videoPlayer.style.display = 'block';
                
                btnsHtml += `<a href="${videoUrl}" class="dl-btn hd" target="_blank" download
                    onclick="onDownload('${esc(title)}', '${esc(author)}', '${thumbnailUrl}', '${originalUrl}', '${videoUrl}', 'video')">
                    <i class="fas fa-download"></i> Video HD</a>`;
            }

            // Check for medias array
            if (videoData.medias && Array.isArray(videoData.medias)) {
                videoData.medias.forEach((media, index) => {
                    if (media.url) {
                        foundMedia = true;
                        const quality = media.quality || media.resolution || media.label || `Quality ${index + 1}`;
                        const extension = media.extension || media.ext || 'mp4';
                        
                        if (index === 0 && !videoUrl) {
                            videoPlayer.src = media.url;
                            videoPlayer.poster = media.thumbnail || thumbnailUrl;
                            videoPlayer.style.display = 'block';
                        }

                        btnsHtml += `<a href="${media.url}" class="dl-btn ${index === 0 ? 'hd' : 'sd'}" target="_blank" download
                            onclick="onDownload('${esc(title)}', '${esc(author)}', '${thumbnailUrl}', '${originalUrl}', '${media.url}', 'video')">
                            <i class="fas fa-download"></i> ${quality} <span class="badge">${extension.toUpperCase()}</span></a>`;
                    }
                });
            }

            // Check for formats (YouTube)
            if (videoData.formats && Array.isArray(videoData.formats)) {
                videoData.formats.slice(0, 6).forEach((format, index) => {
                    if (format.url) {
                        foundMedia = true;
                        const quality = format.qualityLabel || format.quality || format.label || 
                                      (format.height ? `${format.height}p` : `Format ${index + 1}`);
                        
                        if (index === 0 && !videoUrl) {
                            videoPlayer.src = format.url;
                            videoPlayer.poster = thumbnailUrl;
                            videoPlayer.style.display = 'block';
                        }

                        btnsHtml += `<a href="${format.url}" class="dl-btn ${index < 2 ? 'hd' : 'sd'}" target="_blank" download
                            onclick="onDownload('${esc(title)}', '${esc(author)}', '${thumbnailUrl}', '${originalUrl}', '${format.url}', 'video')">
                            <i class="fas fa-download"></i> ${quality}</a>`;
                    }
                });
            }

            // Check for links array
            if (videoData.links && Array.isArray(videoData.links)) {
                videoData.links.forEach((link, index) => {
                    if (link.url || link.link) {
                        foundMedia = true;
                        const dlUrl = link.url || link.link;
                        const quality = link.quality || link.name || link.label || `Option ${index + 1}`;
                        
                        if (index === 0 && !videoUrl && !videoPlayer.src) {
                            videoPlayer.src = dlUrl;
                            videoPlayer.poster = thumbnailUrl;
                            videoPlayer.style.display = 'block';
                        }

                        btnsHtml += `<a href="${dlUrl}" class="dl-btn ${index === 0 ? 'hd' : 'sd'}" target="_blank" download
                            onclick="onDownload('${esc(title)}', '${esc(author)}', '${thumbnailUrl}', '${originalUrl}', '${dlUrl}', 'video')">
                            <i class="fas fa-download"></i> ${quality}</a>`;
                    }
                });
            }

            // Check for image
            const imageUrl = videoData.image_url || videoData.image || videoData.picture;
            if (imageUrl && !foundMedia) {
                foundMedia = true;
                imagePreview.src = imageUrl;
                imagePreview.style.display = 'block';
                
                btnsHtml += `<a href="${imageUrl}" class="dl-btn hd" target="_blank" download
                    onclick="onDownload('${esc(title)}', '${esc(author)}', '${imageUrl}', '${originalUrl}', '${imageUrl}', 'image')">
                    <i class="fas fa-image"></i> Image</a>`;
            }

            // Check for audio
            const audioUrl = videoData.audio_url || videoData.audio || videoData.music || videoData.sound;
            if (audioUrl) {
                foundMedia = true;
                btnsHtml += `<a href="${audioUrl}" class="dl-btn audio" target="_blank" download
                    onclick="onDownload('${esc(title)}', '${esc(author)}', '${thumbnailUrl}', '${originalUrl}', '${audioUrl}', 'audio')">
                    <i class="fas fa-music"></i> Audio</a>`;
            }

            if (foundMedia) {
                document.getElementById('downloadBtns').innerHTML = btnsHtml;
                document.getElementById('videoResult').classList.add('show');
                document.getElementById('videoResult').scrollIntoView({ behavior: 'smooth' });
            } else {
                showStatus('Download links ·Äô·Äê·ÄΩ·Ä±·Ä∑·Äï·Ä´', 'error');
            }
        }

        // ========== DOWNLOAD ==========
        function onDownload(title, author, thumb, origUrl, dlUrl, type) {
            saveHistory({
                id: Date.now(),
                title: title || 'Media',
                author: author || 'Unknown',
                thumb: thumb,
                origUrl: origUrl,
                dlUrl: dlUrl,
                type: type || 'video',
                date: new Date().toISOString(),
                device: getDeviceId()
            });
            incrementStats();
            showToast('Download ·ÄÖ·Äê·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ!', 'success');
        }

        // ========== HISTORY ==========
        function saveHistory(item) {
            let history = JSON.parse(localStorage.getItem(STORAGE.history) || '[]');
            if (!history.some(h => h.origUrl === item.origUrl)) {
                history.unshift(item);
                if (history.length > 20) history = history.slice(0, 20);
                localStorage.setItem(STORAGE.history, JSON.stringify(history));
            }
            loadHistory();
        }

        function loadHistory() {
            const list = document.getElementById('historyList');
            let history = JSON.parse(localStorage.getItem(STORAGE.history) || '[]');
            history = history.filter(h => h.device === getDeviceId());

            if (history.length === 0) {
                list.innerHTML = `<div class="empty-state"><i class="fas fa-download"></i><p>No downloads yet</p></div>`;
                document.getElementById('statSaved').textContent = '0';
                return;
            }

            list.innerHTML = history.map(item => `
                <div class="history-item">
                    <img src="${item.thumb || ''}" class="history-thumb" onerror="this.style.background='#1a2a4a'">
                    <div class="history-info">
                        <div class="history-title">${esc(item.title)}</div>
                        <div class="history-meta">@${esc(item.author)} ‚Ä¢ ${timeAgo(item.date)}</div>
                    </div>
                    <div class="history-actions">
                        <a href="${item.dlUrl}" class="history-btn dl" target="_blank" download><i class="fas fa-download"></i></a>
                        <button class="history-btn del" onclick="deleteHistory(${item.id})"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `).join('');

            document.getElementById('statSaved').textContent = history.length;
        }

        function deleteHistory(id) {
            let history = JSON.parse(localStorage.getItem(STORAGE.history) || '[]');
            history = history.filter(h => h.id !== id);
            localStorage.setItem(STORAGE.history, JSON.stringify(history));
            loadHistory();
        }

        function clearAllHistory() {
            if (confirm('History ·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏·Äñ·Äª·ÄÄ·Ä∫·Äô·Äæ·Ä¨·Äú·Ä¨·Ä∏?')) {
                localStorage.removeItem(STORAGE.history);
                loadHistory();
                showToast('Cleared!', 'success');
            }
        }

        // ========== STATS ==========
        function incrementStats() {
            let stats = JSON.parse(localStorage.getItem(STORAGE.stats) || '{}');
            const today = new Date().toDateString();
            stats.total = (stats.total || 0) + 1;
            if (stats.lastDate !== today) {
                stats.today = 1;
                stats.lastDate = today;
            } else {
                stats.today = (stats.today || 0) + 1;
            }
            localStorage.setItem(STORAGE.stats, JSON.stringify(stats));
            updateStats();
        }

        function updateStats() {
            const stats = JSON.parse(localStorage.getItem(STORAGE.stats) || '{}');
            const today = new Date().toDateString();
            document.getElementById('statTotal').textContent = stats.total || 0;
            document.getElementById('statToday').textContent = (stats.lastDate === today ? stats.today : 0) || 0;
        }

        // ========== UTILS ==========
        function timeAgo(dateStr) {
            const diff = Date.now() - new Date(dateStr).getTime();
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + 'm';
            if (diff < 86400000) return Math.floor(diff / 3600000) + 'h';
            return Math.floor(diff / 86400000) + 'd';
        }

        function esc(str) {
            if (!str) return '';
            return str.replace(/['"<>&]/g, c => ({'\'': '&#39;', '"': '&quot;', '<': '&lt;', '>': '&gt;', '&': '&amp;'}[c]));
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') {
                document.getElementById('donateModal').classList.remove('show');
            }
        });
    </script>
</body>
</html>
